syntax = "proto3";

package matchmaking;

option go_package = "gen/matchmakingpb";

message JoinQueueRequest {
  string player_id = 1;
//   int32 skill_rank = 2;
//   string region = 3;
  string game_mode = 4;
}

message JoinQueueResponse {
  bool success = 1;
}

message LeaveQueueRequest {
  string player_id = 1;
}

message LeaveQueueResponse {
  bool success = 1;
}

message GetQueueStatusRequest {
  string player_id = 1;
}

message QueueStatus {
  int32 position = 1;
  int32 estimated_wait_seconds = 2;
  string status_message = 3;
}

message GetQueueStatusResponse {
  QueueStatus status = 1;
}

message MatchFoundRequest {
  string player_id = 1;
}

message PlayerInfo {
  string player_id = 1;
  int32 skill_rank = 2;
}

message MatchInfo {
  string match_id = 1;
  repeated PlayerInfo players = 2;
  string game_mode = 3;
  string region = 4;
  string session_token = 5;
}

service MatchmakingService {
  rpc JoinQueue(JoinQueueRequest) returns (JoinQueueResponse);
  rpc LeaveQueue(LeaveQueueRequest) returns (LeaveQueueResponse);
  rpc GetQueueStatus(GetQueueStatusRequest) returns (GetQueueStatusResponse);
  
  rpc StreamMatchFound(MatchFoundRequest) returns (stream MatchInfo);
  
  rpc CancelMatch(CancelMatchRequest) returns (CancelMatchResponse);
}

message CancelMatchRequest {
  string player_id = 1;
  string match_id = 2;
}

message CancelMatchResponse {
  bool success = 1;
  string message = 2;
}
